/******************** (C) COPYRIGHT 2012 e-Design Co.,Ltd. *********************
 File Name : Draw.c
 Version   : DS201 Ver 3.0                                       Author : bure
*******************************************************************************/
#include "Draw.h"
#include <string.h>
#include "BIOS.h"
#include "DFU_Func.h"


uc8 DEMO[300] =   //Ñù±¾²¨ÐÎÃèÊö
{100,116,130,144,157,167,175,181,185,185,184,179,173,164,153,141,128,114,100, 86,
  73, 60, 49, 40, 33, 27, 24, 24, 25, 29, 35, 43, 52, 63, 75, 87,100,112,124,135,
 145,153,160,164,167,167,166,163,157,150,142,133,122,111,100, 89, 79, 70, 61, 54,
  48, 44, 42, 42, 43, 46, 50, 57, 64, 72, 81, 90,100,109,118,126,133,139,144,147,
 149,149,148,146,142,137,130,124,116,108,100, 93, 85, 79, 73, 68, 64, 61, 60, 60,
  61, 63, 66, 70, 75, 81, 87, 93,100,106,112,117,122,125,128,130,131,131,131,129,
 126,123,119,115,110,105,100, 96, 91, 88, 84, 81, 79, 78, 77, 78, 78, 80, 82, 84,
  87, 90, 93, 97,100,103,106,108,110,112,113,114,114,113,113,112,110,109,107,105,
 104,102,100,99, 97, 96, 96, 95, 95, 95, 95, 96, 96, 97, 97, 98, 99, 99, 100,100,
 100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
 100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
 100,100,100,100,100,115,129,141,151,160,165,169,170,169,167,162,156,148,139,130,
 120,110,100, 91, 82, 75, 68, 63, 59, 57, 56, 56, 58, 61, 64, 69, 75, 81, 87, 94,
 100,106,112,117,121,125,127,129,130,130,128,127,124,121,117,113,109,104,100, 96,
  92, 88, 85, 83, 81, 80, 79, 79, 80, 81, 83, 85, 88, 91, 94, 97,100,103,106,108};

uc16 SYMB8x14[]={  // ÏÔÊ¾·ûºÅÍ¼ÐÎÊý¾Ý¶¨Òå
  0x7FF8,0x4008,0x5FE8,0x5208,0x5208,0x5008,0x4008,0x7FF8, // @ ·½¿ò F
  0x0FC0,0x0840,0x7878,0x4008,0x4008,0x4008,0x4008,0x4008, // A ¿Õµç³ØÍ·
  0x4008,0x4008,0x4008,0x4008,0x4008,0x4008,0x4008,0x4008, // B ¿Õµç³ØÉí
  0x4008,0x4008,0x4008,0x4008,0x4008,0x4008,0x4008,0x7FF8, // C ¿Õµç³ØÎ²
  0x0010,0x0030,0x0050,0x0190,0x0310,0x0C10,0x3FF0,0x0000, // D Èý½Ç
  0x0FC0,0x0840,0x7878,0x4008,0x5FE8,0x5FE8,0x5FE8,0x5FE8, // E Âúµç³ØÍ·
  0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x5FE8, // F Âúµç³ØÉí
  0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x5FE8,0x4008,0x7FF8, // G Âúµç³ØÎ²
  0x0110,0x0210,0x0610,0x3FF0,0x2600,0x2200,0x2100,0x0000, // H ÉÏÉýÑØ
  0x7FF0,0x7FF0,0x0100,0x0080,0x0100,0x0200,0x0400,0x0800, // I ×ó±ê³ß¶Ë
  0x0400,0x0200,0x0100,0x0080,0x0100,0x0200,0x0400,0x0800, // J ÖÐ±ê³ß¶Ë
  0x0400,0x0200,0x0100,0x0080,0x0100,0x0200,0x7FF0,0x7FF0, // K ÓÒ±ê³ß¶Ë
  0x2200,0x2100,0x2180,0x3FF0,0x0190,0x0110,0x0210,0x0000, // L ÏÂ½µÑØ
  0x0000,0x0000,0x3FF0,0x4008,0x5FE8,0x4808,0x4408,0x43C8, // M ×ó M ¼ü
  0x4408,0x4808,0x5FE8,0x4008,0x3FF0,0x0000,0x0000,0x0000, // N ÓÒ M ¼ü
  0x0F30,0x1990,0x10F0,0x1000,0x10F0,0x1990,0x0F30,0x0000, // O Å·Ä·
  0x0000,0x0000,0x3FF0,0x4008,0x5FE8,0x4FC8,0x4788,0x4308, // P ×ó P ¼ü
  0x4008,0x5FE8,0x4008,0x5FE8,0x4008,0x3FF0,0x0000,0x0000, // Q ÓÒ P ¼ü
  0x0000,0x0000,0x3FF0,0x4008,0x4308,0x4308,0x4308,0x5FE8, // R ×ó + ¼ü
  0x5FE8,0x4308,0x4308,0x4308,0x4008,0x3FF0,0x0000,0x0000, // S ÓÒ + ¼ü
  0x0000,0x0000,0x3FF0,0x4008,0x4308,0x4308,0x4308,0x4308, // T ×ó - ¼ü
  0x4308,0x4308,0x4308,0x4308,0x4008,0x3FF0,0x0000,0x0000, // U ÓÒ - ¼ü
  0x0000,0x0000,0x3FF0,0x4008,0x4308,0x4788,0x4FC8,0x5FE8, // V ×ó < ¼ü
  0x4308,0x4788,0x4FC8,0x5FE8,0x4008,0x3FF0,0x0000,0x0000, // W ÓÒ < ¼ü
  0x0000,0x0440,0x0280,0x0100,0x0280,0x0440,0x0000,0x0000, // X ³ËºÅ
  0x0000,0x0000,0x3FF0,0x4008,0x5FE8,0x4FC8,0x4788,0x4308, // Y ÓÒ > ¼ü
  0x5FE8,0x4FC8,0x4788,0x4308,0x4008,0x3FF0,0x0000,0x0000, // Z ×ó > ¼ü
  0x0FC0,0x0840,0x7878,0x4008,0x4008,0x4F88,0x4048,0x4048, // [ µç³ØÍ·+U
  0x4048,0x4F88,0x4008,0x4448,0x4A48,0x4A48,0x4A48,0x4988, // \ µç³ØÉí+S
  0x4008,0x4FC8,0x4A48,0x4A48,0x4A48,0x4588,0x4008,0x7FF8, // ] µç³ØÎ²+B
  0x0000,0x0420,0x0420,0x1F20,0x0420,0x0420,0x0000,0x0000, // ^ Õý¸ººÅ
  0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000}; // _ ¿Õ¸ñ

uc16 CHAR8x14[]={
  0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000, // _ 0x20
  0x0000,0x0000,0x0000,0x3F30,0x3E30,0x0000,0x0000,0x0000, // !
  0x0000,0x3800,0x3000,0x0000,0x0000,0x0000,0x0000,0x0000, // "
  0x0000,0x0480,0x1FE0,0x0480,0x0480,0x1FE0,0x0480,0x0000, // #
  0x0440,0x0E60,0x0920,0x1FF0,0x0920,0x0DE0,0x04C0,0x0000, // $
  0x1860,0x18C0,0x0180,0x0300,0x0600,0x0C60,0x1860,0x0000, // %
  0x0000,0x00C0,0x0520,0x1B20,0x0AA0,0x0440,0x00A0,0x0000, // &
  0x0000,0x0000,0x0000,0x3800,0x3000,0x0000,0x0000,0x0000, // '
  0x0000,0x0000,0x0FC0,0x1FE0,0x3030,0x2010,0x0000,0x0000, // (
  0x0000,0x0000,0x2010,0x3030,0x1FE0,0x0FC0,0x0000,0x0000, // )
  0x0100,0x0540,0x0380,0x0FE0,0x0380,0x0540,0x0100,0x0000, // *
  0x0000,0x0180,0x0180,0x07E0,0x07E0,0x0180,0x0180,0x0000, // +
  0x0000,0x0000,0x0008,0x0070,0x0060,0x0000,0x0000,0x0000, // ,
  0x0000,0x0180,0x0180,0x0180,0x0180,0x0180,0x0180,0x0000, // -
  0x0000,0x0000,0x0000,0x0030,0x0030,0x0000,0x0000,0x0000, // .
  0x0030,0x0060,0x00C0,0x0180,0x0300,0x0600,0x0C00,0x0000, // /
  0x1FE0,0x3FF0,0x2090,0x2310,0x2410,0x3FF0,0x1FE0,0x0000, // 0
  0x0000,0x0810,0x1810,0x3FF0,0x3FF0,0x0010,0x0010,0x0000, // 1
  0x1070,0x30F0,0x2190,0x2310,0x2610,0x3C30,0x1830,0x0000, // 2
  0x1020,0x3030,0x2210,0x2210,0x2210,0x3FF0,0x1DE0,0x0000, // 3
  0x0300,0x0700,0x0D00,0x1910,0x3FF0,0x3FF0,0x0110,0x0000, // 4
  0x3E20,0x3E30,0x2210,0x2210,0x2310,0x23F0,0x21E0,0x0000, // 5
  0x0FE0,0x1FF0,0x3210,0x2210,0x2210,0x03F0,0x01E0,0x0000, // 6
  0x3000,0x3000,0x21F0,0x23F0,0x2600,0x3C00,0x3800,0x0000, // 7
  0x1DE0,0x3FF0,0x2210,0x2210,0x2210,0x3FF0,0x1DE0,0x0000, // 8
  0x1C00,0x3E10,0x2210,0x2210,0x2230,0x3FE0,0x1FC0,0x0000, // 9
  0x0000,0x0000,0x0000,0x0C60,0x0C60,0x0000,0x0000,0x0000, // :
  0x0000,0x0000,0x0008,0x0C70,0x0C60,0x0000,0x0000,0x0000, // ;
  0x0000,0x0100,0x0380,0x06C0,0x0C60,0x1830,0x1010,0x0000, // <
  0x0240,0x0240,0x0240,0x0240,0x0240,0x0240,0x0240,0x0000, // =
  0x0000,0x1010,0x1830,0x0C60,0x06C0,0x0380,0x0100,0x0000, // >
  0x1800,0x3800,0x21B0,0x23B0,0x2600,0x3C00,0x1800,0x0000, // ?
  0x0FC0,0x1020,0x2790,0x2490,0x27D0,0x1050,0x0F80,0x0000, // @
  0x07F0,0x0FF0,0x1900,0x3100,0x1900,0x0FF0,0x07F0,0x0000, // A
  0x2010,0x3FF0,0x3FF0,0x2210,0x2210,0x3FF0,0x1DE0,0x0000, // B
  0x0FC0,0x1FE0,0x3030,0x2010,0x2010,0x3030,0x1860,0x0000, // C
  0x2010,0x3FF0,0x3FF0,0x2010,0x3030,0x1FE0,0x0FC0,0x0000, // D
  0x2010,0x3FF0,0x3FF0,0x2210,0x2710,0x3030,0x3870,0x0000, // E
  0x2010,0x3FF0,0x3FF0,0x2210,0x2700,0x3000,0x3800,0x0000, // F
  0x0FC0,0x1FE0,0x3030,0x2110,0x2110,0x31E0,0x19F0,0x0000, // G
  0x3FF0,0x3FF0,0x0200,0x0200,0x0200,0x3FF0,0x3FF0,0x0000, // H
  0x0000,0x0000,0x2010,0x3FF0,0x3FF0,0x2010,0x0000,0x0000, // I
  0x00E0,0x00F0,0x0010,0x2010,0x3FF0,0x3FE0,0x2000,0x0000, // J
  0x2010,0x3FF0,0x3FF0,0x0300,0x0F80,0x3CF0,0x3070,0x0000, // K
  0x2010,0x3FF0,0x3FF0,0x2010,0x0010,0x0030,0x0030,0x0000, // L
  0x3FF0,0x3FF0,0x1C00,0x0E00,0x1C00,0x3FF0,0x3FF0,0x0000, // M
  0x3FF0,0x3FF0,0x1800,0x0C00,0x0600,0x3FF0,0x3FF0,0x0000, // N
  0x0FC0,0x1FE0,0x3030,0x2010,0x3030,0x1FE0,0x0FC0,0x0000, // O
  0x2010,0x3FF0,0x3FF0,0x2210,0x2200,0x3E00,0x1C00,0x0000, // P
  0x1FE0,0x3FF0,0x2010,0x2070,0x2030,0x3FF8,0x1FE8,0x0000, // Q
  0x2010,0x3FF0,0x3FF0,0x2200,0x2300,0x3FF0,0x1CF0,0x0000, // R
  0x1860,0x3C70,0x2610,0x2210,0x2310,0x39F0,0x18E0,0x0000, // S
  0x0000,0x3800,0x3010,0x3FF0,0x3FF0,0x3010,0x3800,0x0000, // T
  0x3FE0,0x3FF0,0x0010,0x0010,0x0010,0x3FF0,0x3FE0,0x0000, // U
  0x3F80,0x3FC0,0x0060,0x0030,0x0060,0x3FC0,0x3F80,0x0000, // V
  0x3FC0,0x3FF0,0x0070,0x01C0,0x0070,0x3FF0,0x3FC0,0x0000, // W
  0x3030,0x3CF0,0x0FC0,0x0300,0x0FC0,0x3CF0,0x3030,0x0000, // X
  0x0000,0x3C00,0x3E10,0x03F0,0x03F0,0x3E10,0x3C00,0x0000, // Y
  0x3870,0x30F0,0x2190,0x2310,0x2610,0x3C30,0x3870,0x0000, // Z
  0x0000,0x0000,0x1FE0,0x3FF0,0x2010,0x2010,0x0000,0x0000, // [
  0x0C00,0x0600,0x0300,0x0180,0x00C0,0x0060,0x0030,0x0000, // '\'
  0x0000,0x0000,0x2010,0x2010,0x3FF0,0x1FE0,0x0000,0x0000, // ]
  0x0800,0x1000,0x2000,0x1000,0x0800,0x0000,0x0000,0x0000, // ^
  0x0010,0x0010,0x0010,0x0010,0x0010,0x0010,0x0010,0x0000, // _
  0x0000,0x0000,0x0000,0x3000,0x0800,0x0000,0x0000,0x0000, // `
  0x01E0,0x0BF0,0x0A10,0x0A10,0x0FE0,0x07F0,0x0010,0x0000, // a
  0x2010,0x3FF0,0x3FE0,0x0210,0x0210,0x03F0,0x01E0,0x0000, // b
  0x03E0,0x07F0,0x0410,0x0410,0x0410,0x0630,0x0220,0x0000, // c
  0x01E0,0x03F0,0x0210,0x2210,0x3FF0,0x3FF0,0x0010,0x0000, // d
  0x03E0,0x07F0,0x0510,0x0510,0x0510,0x0730,0x0320,0x0000, // e
  0x0000,0x0210,0x1FF0,0x3FF0,0x2210,0x3000,0x1800,0x0000, // f
  0x03C8,0x07EC,0x0424,0x0424,0x03FC,0x07F8,0x0400,0x0000, // g
  0x2010,0x3FF0,0x3FF0,0x0200,0x0400,0x07F0,0x03F0,0x0000, // h
  0x0000,0x0000,0x0410,0x37F0,0x37F0,0x0010,0x0000,0x0000, // i
  0x0000,0x0018,0x001C,0x0404,0x37FC,0x37F8,0x0400,0x0000, // j
  0x2010,0x3FF0,0x3FF0,0x0180,0x03C0,0x0670,0x0430,0x0000, // k
  0x0000,0x0000,0x2010,0x3FF0,0x3FF0,0x0010,0x0000,0x0000, // l
  0x07F0,0x07F0,0x0600,0x03F0,0x0600,0x07F0,0x03F0,0x0000, // m
  0x0400,0x07F0,0x03F0,0x0400,0x0400,0x07F0,0x03F0,0x0000, // n
  0x03E0,0x07F0,0x0410,0x0410,0x0410,0x07F0,0x03E0,0x0000, // o
  0x0404,0x07FC,0x03FC,0x0424,0x0420,0x07E0,0x03C0,0x0000, // p
  0x03C0,0x07E0,0x0420,0x0424,0x07FC,0x03FC,0x0404,0x0000, // q
  0x0410,0x07F0,0x03F0,0x0610,0x0400,0x0600,0x0300,0x0000, // r
  0x0000,0x0220,0x0730,0x0590,0x0490,0x06F0,0x0260,0x0000, // s
  0x0400,0x0400,0x1FE0,0x3FF0,0x0410,0x0430,0x0020,0x0000, // t
  0x07E0,0x07F0,0x0010,0x0010,0x07E0,0x07F0,0x0010,0x0000, // u
  0x0000,0x07C0,0x07E0,0x0030,0x0030,0x07E0,0x07C0,0x0000, // v
  0x07E0,0x07F0,0x0030,0x00E0,0x0030,0x07F0,0x07E0,0x0000, // w
  0x0410,0x0630,0x03E0,0x01C0,0x03E0,0x0630,0x0410,0x0000, // x
  0x0780,0x07C4,0x0044,0x0044,0x0044,0x07F8,0x07F0,0x0000, // y
  0x0630,0x0670,0x04D0,0x0590,0x0710,0x0630,0x0430,0x0000, // z
  0x0000,0x0100,0x0380,0x1C70,0x2008,0x2008,0x0000,0x0000, // {
  0x0000,0x0000,0x0000,0x3FF0,0x0000,0x0000,0x0000,0x0000, // |
  0x2008,0x2008,0x1C70,0x0380,0x0100,0x0000,0x0000,0x0000, // }
  0x0100,0x0200,0x0200,0x0100,0x0080,0x0080,0x0100,0x0000};// ~

s16 ParamTab[41] = {// ÏÔÊ¾±äÁ¿²ÎÊý±í
//+======+======+======+======+======+======+======+======+======+======+======+
//   P1F,   P2F,   P3F,   P4F,   VTF,   V1F,   V2F,   T0F,   T1F,   T2F,        ÏûÒþÏî
//+------+------+------+------+------+------+------+------+------+------+------+
   L_HID, L_HID, A_HID, A_HID,  SHOW,  SHOW,  SHOW,  SHOW,  SHOW,  SHOW,
//+======+======+======+======+======+======+======+======+======+======+======+
//  P1x2,  P1x2,  P1x2,  P1x2,  VTx2,  V1x2,  V2x2,  T0x1,  T1x1,  T2x1,        ÊýÖµÏî
//+------+------+------+------+------+------+------+------+------+------+------+
     300,   200,   120,    20,   320,   360,    60,   150,    40,   290,
//+======+======+======+======+======+======+======+======+======+======+======+
//   PC1,   PC2,   PC3,   PC4,   VTC,   V1C,   V2C,   T0C,   T1C,   T2C,        ÑÕÉ«Ïî
//+------+------+------+------+------+------+------+------+------+------+------+
     CYN,   PUR,   YEL,   GRN,   GRN,   WHT,   WHT,   ORN,   WHT,   WHT,
//+======+======+======+======+======+======+======+======+======+======+======+
//  PC1_,  PC2_,  PC3_,  PC4_,  BXx1,  WXx1,  BYx2,  HYx2, POP_F, POP_B, POP_C   ÆäËüÏî
//+------+------+------+------+------+------+------+------+------+------+------+
    CYN_,  PUR_,  YEL_,  GRN_,   180,   100,    26,   256, P_HID,   DAR,   WHT };
//+======+======+======+======+======+======+======+======+======+======+======+

u8  WaveBuf[TRACK1_SIZE + TRACK2_SIZE + TRACK23_SIZE + POP_SIZE]; // ÏÔÊ¾»º³åÇø
//u8  PopEn = P_HID, DialogEn = 0, Data[300] = {100};
u8  PopType = DEMO_POP,Data[300] = {100} ;
u8  Cal_flag = 0;

u16 Hy = 128, Wx = 100;       // µ¯³ö´°³¤¿í³ß´ç
u16 Nx = 5,   Ny = 5;         // µ¯³ö´°µ±Ç°ÏÔÊ¾Î»ÖÃ
u16 Sx = 0,   Sy = 0;         // Ö÷ÆÁÄ»µ±Ç°ÏÔÊ¾Î»ÖÃ
u16 Background, Foreground;   // Ö÷ÆÁÄ»µ±Ç°ÏÔÊ¾ÑÕÉ«
s16 Dx = 1, Dy = 2;

/*******************************************************************************
 PopColor: µ¯³ö´°ÑÕÉ«ÉèÖÃ
*******************************************************************************/
void PopColor(u16 Board_Color, u16 Text_Color)
{
  ParamTab[POP_B] = Board_Color;
  ParamTab[POP_T] = Text_Color;
}
/*******************************************************************************
 SetColor: LCDÆÁÄ»ÑÕÉ«ÉèÖÃ
*******************************************************************************/
void SetColor(u16 Board_Color, u16 Text_Color)
{
  Background = Board_Color;
  Foreground = Text_Color;
}
/*******************************************************************************
 NotePixel: µ¯³ö´°ÏñËØÉèÖÃ     Color: ÏñËØÑÕÉ«(1/0)  ÏñËØ¶¨Î»: Nx, Ny
*******************************************************************************/
void NotePixel(u8 Color)
{
  u16 i, j, *pBuf = (u16*)&WaveBuf[300 + 300 + 300];

  Nx = Nx%ParamTab[WXx1];
  Ny = Ny%ParamTab[HYx2];             // Nx, Ny ³¬½çÔò·µ»ØÆðµã
  i  = Nx*(ParamTab[HYx2]/32)+ Ny/16;
  j  = Ny%16;
  if(Color) pBuf[i] |=  1 << j;
  else      pBuf[i] &=~(1 << j);
  Ny++;
}
/*******************************************************************************
  NoteSide: Çå³ýµ¯³ö´°ÄÚÈÝ¼°»­±³¾°¿ò   ÊäÈë²ÎÊý: Nx, Ny, Wx, Hy
*******************************************************************************/
void Buil_Pop(void)
{
  u16 i;
  memset(&WaveBuf[TRACK1_SIZE+TRACK2_SIZE+TRACK23_SIZE], BLK, POP_SIZE);
  Nx = 0; Ny = 3; for(i=0; i<ParamTab[HYx2]/2-6; i++) NotePixel(1);
  Nx = 1; Ny = 2;                    NotePixel(1);
  Nx = 1; Ny = ParamTab[HYx2]/2 - 3; NotePixel(1);
  Nx = 2; Ny = 1;                    NotePixel(1);
  Nx = 2; Ny = ParamTab[HYx2]/2 - 2; NotePixel(1);
  for(Nx=3; Nx<ParamTab[WXx1]-2; Nx++){
    Ny = 0;                     NotePixel(1);
    Ny = ParamTab[HYx2]/2 - 1;; NotePixel(1);
  }
  Nx = ParamTab[WXx1]-3; Ny = 1;                    NotePixel(1);
  Nx = ParamTab[WXx1]-3; Ny = ParamTab[HYx2]/2 - 2; NotePixel(1);
  Nx = ParamTab[WXx1]-2; Ny = 2;                    NotePixel(1);
  Nx = ParamTab[WXx1]-2; Ny = ParamTab[HYx2]/2 - 3; NotePixel(1);
  Nx = ParamTab[WXx1]-1; Ny = 3; for(i=0; i<ParamTab[HYx2]/2-6; i++) NotePixel(1);
}
/*******************************************************************************
 NoteChar: µ¯³ö´°ÄÚÏÔÊ¾×Ö·û/Í¼¿é       Mode = bit0: Normal/Inv, bit1: Char/Symb
*******************************************************************************/
void NoteChar(u8 Mode, u8 Code)
{
  u16 i, j, k;

  for(i=0; i<8; ++i){
    if(Mode & SYMB) k = SYMB8x14[(Code - '@')*8 + i];
    else            k = __Font_8x14(Code, i); // k = CHAR8x14[(Code - ' ')*8 + i];

    if(Mode & VOID) k &= (i%2)? 0xAAAA : 0x5555;
    for(j=0; j<14; ++j){
      if(k & 4)  NotePixel((Mode & INV)? 0 : 1);
      else       NotePixel((Mode & INV)? 1 : 0);
      k >>= 1;
    }
    Nx++; Ny -= 14;
  }
}
/*******************************************************************************
 NoteSTR: µ¯³ö´°ÄÚÏÔÊ¾×Ö·û/Í¼¿é´®      Mode = bit0: Normal/Inv, bit1: Char/Symb
*******************************************************************************/
void NoteSTR(u16 Nx0, u16 Ny0, u8 Mode, u8 *Str)
{
  u8 i;
  Nx = Nx0, Ny = Ny0;
  for (i=0; i<14; i++) NotePixel((Mode & INV)? 1 : 0);
  Nx++,     Ny = Ny0;                            // Ã¿Ò»¸ö×Ö·û´®Ç°Ôö¼ÓÒ»¿Õ°×ÁÐ
  while(*Str != 0){
    NoteChar(Mode, *Str++);
  }
}
/*******************************************************************************
 Disp_Char: Ö÷ÆÁÄ»ÏÔÊ¾×Ö·û/Í¼¿é         Mode = bit0: Normal/Inv, bit1: Char/Map
*******************************************************************************/
void DispChar(u8 Mode, u8 Code)
{
  u16 i, j, k;

  for(i=0; i<8; ++i){
    if(Mode & SYMB) k = SYMB8x14[(Code - '@')*8 + i];
    else            k = __Font_8x14(Code, i); // k = CHAR8x14[(Code - ' ')*8 + i];
    if(Mode & VOID) k &= (i%2)? 0xAAAA : 0x5555;
    __Set_Posi(Sx, Sy);
    for(j=0; j<14; ++j){
      if(k & 4)  __Set_Pixel((Mode & INV)? Background : Foreground);
      else       __Set_Pixel((Mode & INV)? Foreground : Background);
      k >>= 1;
    }
    Sx++;
  }
}
/*******************************************************************************
  DispStr: Ö÷ÆÁÄ»ÏÔÊ¾×Ö·û/Í¼¿é´®        Mode = bit0: Normal/Inv, bit1: Char/Map
*******************************************************************************/
void DispStr(u16 x0, u16 y0, u8 Mode, u8 *Str)
{
  u16 i ;
  Sx = x0; Sy = y0;
  __Set_Posi(Sx, Sy);
  for (i=0; i<14; i++) __Set_Pixel((Mode & INV)? Foreground : Background);
  Sx++;                                   // Ã¿Ò»¸ö×Ö·û´®Ç°Ôö¼ÓÒ»¿Õ°×ÁÐ
  while(*Str != 0){
    DispChar(Mode, *Str++);
  }
}
/*******************************************************************************
  List_Pop: ´ò¿ª²Ëµ¥´°
*******************************************************************************/
void List_Pop(void)
{
  PopType |= LIST_POP;
  ParamTab[POP_F] = SHOW;

}
/*******************************************************************************
  Close_Pop: ¹Ø±Õ²Ëµ¥´°¼°»á»°´°
*******************************************************************************/
void Close_Pop(void)
{
  PopType &= ~(LIST_POP | DAILOG_POP);
  if(!(PopType & DEMO_POP)) ParamTab[POP_F] = P_HID;
  else Demo_Pop();

}
/*******************************************************************************
  Move_Pop: ´ò¿ª¼°ÓÎ¶¯ÑÝÊ¾´°
*******************************************************************************/
void Demo_Pop(void)
{
  ParamTab[WXx1]= 40;
  ParamTab[HYx2]= 2*48;
  PopColor(BLK, ORN);
  Buil_Pop();
  NoteSTR(4, 26,  PRN, "Demo");
  NoteSTR(4, 10, PRN,  "only");
  ParamTab[POP_F] = SHOW;
  if((ParamTab[BXx1]<= 3)||((ParamTab[BXx1]+ParamTab[WXx1])>= 301)) Dx = -Dx;
  ParamTab[BXx1] += Dx;
  if((ParamTab[BYx2]<= 6)||((ParamTab[BYx2]+ParamTab[HYx2])>= 402)) Dy = -Dy;
  ParamTab[BYx2] += Dy;
}
/*******************************************************************************
  Dialog_Pop: µ¯³ö»á»°´°
*******************************************************************************/
void Dialog_Pop(u8* Str)
{
  PopType |= DAILOG_POP;
  ParamTab[WXx1]= 16*8;
  ParamTab[HYx2]= 2*3*16;
  ParamTab[BXx1]= 50;
  ParamTab[BYx2]= 200;
  PopColor(DAR, WHT);
  Buil_Pop();
  NoteSTR( 1*8, 26, PRN, Str);
  NoteSTR( 1*8, 10, SYMB,  "PQ");
  NoteSTR( 3*8, 10, PRN,  ":Yes");
  NoteSTR(10*8, 10, SYMB,  "MN");
  NoteSTR(12*8, 10, PRN,  ":No");
  ParamTab[POP_F] = SHOW;
}
/*******************************************************************************
  Calibrate_Pop: µ¯³ö»á»°´°
*******************************************************************************/
void Calibrate_Pop(u8* Str)
{
  PopType |= DAILOG_POP;
  ParamTab[WXx1]= 25*8;
  ParamTab[HYx2]= 4*16;
  ParamTab[BXx1]= 50;
  ParamTab[BYx2]= 230;
  PopColor(DAR, WHT);
  Buil_Pop();
  NoteSTR( 1*8, 10, PRN, Str);
  ParamTab[POP_F] = SHOW;
}
/*******************************************************************************
  Dialog_Pop: µ¯³ö»á»°´°
*******************************************************************************/
void CalSave_Pop(u8* Str)
{
  PopType |= DAILOG_POP;
  ParamTab[WXx1]= 30*8;
  ParamTab[HYx2]= 6*16;
  ParamTab[BXx1]= 30;
  ParamTab[BYx2]= 200;
  PopColor(DAR, WHT);
  Buil_Pop();
  NoteSTR( 1*8, 28, PRN, "Complete Cal,");
  NoteSTR( 15*8, 28, PRN, Str);
  NoteSTR( 5*8, 6, SYMB,  "PQ");
  NoteSTR( 7*8, 6, PRN,  ":Yes");
  NoteSTR(20*8, 6, SYMB,  "MN");
  NoteSTR(22*8, 6, PRN,  ":No");
  ParamTab[POP_F] = SHOW;
}
/******************************** END OF FILE *********************************/
